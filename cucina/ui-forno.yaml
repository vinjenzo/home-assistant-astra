type: vertical-stack
cards:
  # ============================================================
  # INTESTAZIONE
  # ============================================================
  - type: markdown
    content: |
      ## üî• Controllo Forno
      Tostatura pane e monitoraggio
    card_mod:
      style: |
        ha-card {
          background: rgba(255,255,255,0.05);
          border-radius: 12px;
          padding: 8px;
        }

  # ============================================================
  # STATO FORNO
  # ============================================================
  - type: horizontal-stack
    cards:
      - type: custom:button-card
        styles:
          card:
            - width: 12px
            - background: transparent
            - border: none
            - box-shadow: none
            - padding: 0
            - cursor: default
        tap_action:
          action: none
      - type: custom:button-card
        entity: switch.forno_potenza
        name: Alimentazione
        icon: mdi:power
        show_state: false
        tap_action:
          action: toggle
        styles:
          card:
            - background: |
                [[[
                  return entity.state === 'on' 
                    ? 'rgba(76,175,80,0.08)' 
                    : 'rgba(158,158,158,0.08)';
                ]]]
            - border-radius: 12px
            - border: |
                [[[
                  return entity.state === 'on' 
                    ? '1px solid rgba(76,175,80,0.3)' 
                    : '1px solid rgba(158,158,158,0.2)';
                ]]]
          icon:
            - width: 40px
            - color: |
                [[[
                  return entity.state === 'on' ? '#4caf50' : 'rgba(255,255,255,0.4)';
                ]]]
          name:
            - color: white
            - font-size: 13px

      - type: custom:button-card
        entity: sensor.forno_temperatura_c
        name: Temperatura
        icon: mdi:thermometer
        show_state: true
        tap_action:
          action: more-info
        styles:
          card:
            - background: rgba(255,87,34,0.08)
            - border-radius: 12px
            - border: 1px solid rgba(255,87,34,0.2)
          icon:
            - width: 40px
            - color: "#ff5722"
          name:
            - color: white
            - font-size: 13px
          state:
            - color: white
            - font-weight: bold
            - font-size: 18px
      - type: custom:button-card
        styles:
          card:
            - width: 12px
            - background: transparent
            - border: none
            - box-shadow: none
            - padding: 0
            - cursor: default
        tap_action:
          action: none

  # ============================================================
  # COMANDI TOSTATURA
  # ============================================================
  - type: markdown
    content: "### üçû Tostatura Pane"
    card_mod:
      style: |
        ha-card {
          background: rgba(255,255,255,0.03);
          padding: 8px;
          border-radius: 8px;
          margin-top: 12px;
        }

  - type: horizontal-stack
    cards:
      - type: custom:button-card
        styles:
          card:
            - width: 12px
            - background: transparent
            - border: none
            - box-shadow: none
            - padding: 0
            - cursor: default
        tap_action:
          action: none
      - type: custom:button-card
        name: Avvia
        icon: mdi:play-circle
        tap_action:
          action: call-service
          service: script.turn_on
          service_data:
            entity_id: script.forno_tosta_pane_timer
        styles:
          card:
            - background: rgba(76,175,80,0.08)
            - border-radius: 12px
            - border: 1px solid rgba(76,175,80,0.2)
          icon:
            - width: 40px
            - color: "#4caf50"
          name:
            - color: white
            - font-size: 13px

      - type: custom:button-card
        name: Stop
        icon: mdi:stop-circle
        tap_action:
          action: call-service
          service: script.turn_on
          service_data:
            entity_id: script.forno_tostatura_stop
        styles:
          card:
            - background: rgba(244,67,54,0.08)
            - border-radius: 12px
            - border: 1px solid rgba(244,67,54,0.2)
          icon:
            - width: 40px
            - color: "#f44336"
          name:
            - color: white
            - font-size: 13px
      - type: custom:button-card
        styles:
          card:
            - width: 12px
            - background: transparent
            - border: none
            - box-shadow: none
            - padding: 0
            - cursor: default
        tap_action:
          action: none

  # ============================================================
  # IMPOSTAZIONI TOSTATURA
  # ============================================================
  - type: horizontal-stack
    cards:
      - type: custom:button-card
        styles:
          card:
            - width: 12px
            - background: transparent
            - border: none
            - box-shadow: none
            - padding: 0
            - cursor: default
        tap_action:
          action: none
      - type: custom:button-card
        entity: input_number.forno_tosta_minuti
        name: Minuti
        icon: mdi:timer
        show_state: true
        tap_action:
          action: more-info
        styles:
          card:
            - background: rgba(251,192,45,0.08)
            - border-radius: 12px
            - border: 1px solid rgba(251,192,45,0.2)
          icon:
            - width: 40px
            - color: "#fbc02d"
          name:
            - color: white
            - font-size: 13px
          state:
            - color: white
            - font-weight: bold
            - font-size: 18px

      - type: custom:button-card
        entity: input_number.forno_tosta_celsius
        name: Temperatura
        icon: mdi:thermometer-lines
        show_state: true
        state_display: "[[[ return `${entity.state}¬∞C` ]]]"
        tap_action:
          action: more-info
        styles:
          card:
            - background: rgba(255,112,67,0.08)
            - border-radius: 12px
            - border: 1px solid rgba(255,112,67,0.2)
          icon:
            - width: 40px
            - color: "#ff7043"
          name:
            - color: white
            - font-size: 13px
          state:
            - color: white
            - font-weight: bold
            - font-size: 18px
      - type: custom:button-card
        styles:
          card:
            - width: 12px
            - background: transparent
            - border: none
            - box-shadow: none
            - padding: 0
            - cursor: default
        tap_action:
          action: none

  # ============================================================
  # TIMER E STATO
  # ============================================================
  - type: custom:button-card
    entity: sensor.forno_tosta_tempo_rimanente
    name: Tempo Rimanente (Timer)
    icon: mdi:timer-sand
    show_state: true
    tap_action:
      action: more-info
    styles:
      card:
        - background: |
            [[[
              const state = states['timer.forno_tosta'].state;
              if (state === 'active') return 'rgba(255,193,7,0.08)';
              return 'rgba(158,158,158,0.05)';
            ]]]
        - border-radius: 12px
        - border: |
            [[[
              const state = states['timer.forno_tosta'].state;
              if (state === 'active') return '1px solid rgba(255,193,7,0.3)';
              return '1px solid rgba(158,158,158,0.15)';
            ]]]
        - padding: 16px
      icon:
        - width: 50px
        - color: |
            [[[
              const state = states['timer.forno_tosta'].state;
              if (state === 'active') return '#ffc107';
              return '#9e9e9e';
            ]]]
      name:
        - color: white
        - font-size: 16px
        - font-weight: bold
      state:
        - color: white
        - font-size: 24px
        - font-weight: bold
        - margin-top: 8px

  # ============================================================
  # TEMPO RIMANENTE PROGRAMMA FORNO
  # ============================================================
  - type: custom:button-card
    entity: sensor.forno_tempo_rimanente
    name: Tempo Rimanente (Programma Forno)
    icon: mdi:clock-time-eight
    show_state: true
    tap_action:
      action: more-info
    styles:
      card:
        - background: rgba(33,150,243,0.08)
        - border-radius: 12px
        - border: 1px solid rgba(33,150,243,0.2)
        - padding: 16px
      icon:
        - width: 50px
        - color: "#42a5f5"
      name:
        - color: white
        - font-size: 16px
        - font-weight: bold
      state:
        - color: white
        - font-size: 24px
        - font-weight: bold
        - margin-top: 8px

  # ============================================================
  # INFO
  # ============================================================
  - type: markdown
    content: |
      ### ‚ÑπÔ∏è Note

      **Timer**: Gestito localmente da Home Assistant  
      **Programma Forno**: Tempo calcolato dall'integrazione Home Connect  
      **Temperatura**: Quella impostata √® per il timer locale (se disponibile)
    card_mod:
      style: |
        ha-card {
          background: rgba(255,255,255,0.03);
          border-radius: 12px;
          padding: 12px;
          margin-top: 12px;
        }
        ha-markdown {
          font-size: 13px;
          line-height: 1.5;
        }
